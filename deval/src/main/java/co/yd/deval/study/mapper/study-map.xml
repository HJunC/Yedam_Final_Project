<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.yd.deval.study.mapper.StudyMapper">


	<select id="studySelectAll"
		resultType="co.yd.deval.study.service.StudyVO">
		SELECT *
		FROM STUDY
		WHERE STATE = '0'
		ORDER BY STUDY_NO DESC
	</select>
	
	<select id="studySelectNo"
		resultType="co.yd.deval.study.service.StudyVO">
		SELECT *
		FROM STUDY
		WHERE STUDY_NO = #{studyNo}

	</select>

	<insert id="studyInsert"
		parameterType="co.yd.deval.study.service.StudyVO">
		<selectKey keyProperty="studyNo" resultType="int"
			order="BEFORE">
			SELECT NVL(MAX(STUDY_NO),0)+1 AS "studyNo"
			FROM STUDY
		</selectKey>
		INSERT INTO STUDY (STUDY_NO,
						LANG1,
						LOCATION,
						SUBJECT,
						UPLOAD_DATE,
						MAX_RCNT,
						DEFFICULTY,
						LEADER_ID,
						STUDY_SDT,
						STUDY_EDT,
						STATE,
						STUDY_NM,
						LANG2)
						
		VALUES (		#{studyNo}, 
						#{lang1}, 
						#{location}, 
						#{subject},
						SYSDATE, 
						#{maxRcnt},
						#{defficulty}, 
						#{leaderId},
						#{studySdt},
						#{studyEdt}, 
						'0', 
						#{studyNm}, 
						#{lang2})
	</insert>

	<update id="studyUpdate"
		parameterType="co.yd.deval.study.service.StudyVO">
		UPDATE STUDY
		<set>
			<if test="lang1 	 != null and lang1 != ''"> LANG1 =#{lang1},</if>
			<if test="location   != null and lang1 != ''" > LOCATION =#{location},</if>
			<if test="subject    != null and lang1 != ''"> SUBJECT =#{subject},</if>
			<if test="maxRcnt 	 != null and lang1 != ''"> MAX_RCNT =#{maxRcnt},</if>
			<if test="defficulty != null and lang1 != ''"> DEFFICULTY =#{defficulty},</if>
			<if test="leaderId 	 != null and lang1 != ''"> LEADER_ID =#{leaderId},</if>
			<if test="studySdt   != null and lang1 != ''"> STUDY_SDT =#{studySdt},</if>
			<if test="studyEdt   != null and lang1 != ''"> STUDY_EDT =#{studyEdt},</if>
			<if test="studyNm    != null and lang1 != ''"> STUDY_NM =#{studyNm},</if>
			<if test="lang2   	 != null and lang1 != ''"> LANG2 =#{lang2},</if>
		</set>
		WHERE STUDY_NO = #{studyNo}
	</update>

</mapper>